# h5 Final Countdown

### x) Read and summarize

Karvinen 2022: [Cracking Passwords with Hashcat](https://terokarvinen.com/2022/cracking-passwords-with-hashcat/)

- Hashcat is used to crack passwords or hashes
- You need to know the type of the hash to crack it with Hashcat
- Parameter `-m` is used to define the type of the hash

Karvinen 2023: [Crack File Password With John](https://terokarvinen.com/2023/crack-file-password-with-john/)

- John can be used to crack ZIP file passwords
- You can complle a free version of John the Ripper or you can buy a paid version
- John can be used to crack passwords many different file types for example telegram or vdi or ZIP


Karvinen 2023: [Find Hidden Web Directories - Fuzz URLs with ffuf](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)

- Fuff is a tool which tries different words from a wordlist to find hidden directories
- Fuff is used with `./ffuf -w wordlist -u http://target/Fuzz
- You can use `-fs` to filter by size, `-fl` to filter by lines, `-fw` to filter by words or you can use a lot of other parameters

### y) 

**All of the exercises below are done with Kali Linux 2023.1 virtual machine**

### a) Install Hashcat and test it by cracking example password 

Example password is taken from Karvinen 2022: [Cracking Passwords with Hashcat](https://terokarvinen.com/2022/cracking-passwords-with-hashcat/)

First I started by installing Hashcat

    $ sudo apt-get update
    $ sudo apt-get -y install micro hashcat bash-completion

I made a directory for this exercise
	
    $ mkdir hashed
    $ cd hashed

I downloaded _rockyou.txt_ password list tar ball

    $ wget https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz

And extracted it and deleted the tar ball

    $ tar xf rockyou.txt.tar.gz
    $ rm rockyou.txt.tar.gz

I checked a few of the passwords

    $ head rockyou.txt
    123456
    12345
    123456789

And then I took a word and line count of the password list	
	
    $ man wc
    $ wc -l -w rockyou.txt
    14344391  14442061 rockyou.txt

I used `hashid` to find out what type of hash this could be

    $ hashid -m 6b1628b016dff46e6fa35684be6acc96
	Analyzing '6b1628b016dff46e6fa35684be6acc96'
	[+] MD2 
	[+] MD5 [Hashcat Mode: 0]
	[+] MD4 [Hashcat Mode: 900]
	...
	
I decided to try MD5 first because it is more commonly used than MD2 or MD4

    $ hashcat -m 0 '6b1628b016dff46e6fa35684be6acc96' rockyou.txt -o solved
	$ cat solved
	6b1628b016dff46e6fa35684be6acc96:summer



### b) Salainen, mutta ei multa. Ratkaise dirfuzt-1 artikkelista Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf

First I needed to install FFUF

	$ wget https://github.com/ffuf/ffuf/releases/download/v2.0.0/ffuf_2.0.0_linux_amd64.tar.gz
    $ tar xf ffuf_2.0.0_linux_amd64.tar.gz

And then I downloaded _common.txt_ wordlist which is made of common words used for Directories

    $ wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt

I checked 3 first words of _common.txt_

    $ head -3 common.txt
	.bash_history
	.bashrc
	.cache

I downloaded _dirfuzt-1_

	$ wget https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/dirfuzt-1
	
And made it executadle

	$ chmod u+x dirfuzt-1

I started _dirfuzt-1_ in another terminal

	$ ./dirfuzt-1
	Learn more at TeroKarvinen.com
	http://127.0.0.2:8000
	
![image](https://github.com/aavetatu/pentesting-course/assets/52470440/df9bee23-4bc4-4c5e-8a9a-af7036ffdb99)
	
I started fuzzing 

	./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ
	
![image](https://github.com/aavetatu/pentesting-course/assets/52470440/dfac7e9a-c023-4634-84ae-b30db90f17aa)

Because all of the responses looked the same to me I decided to use `-fs` parameter on my next fuzzing attempt. `-fs` stands for _filter by size_

	$ ./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 154
	
![image](https://github.com/aavetatu/pentesting-course/assets/52470440/9bbba00a-ed9d-4430-94af-6e1a0bc73671)

Only the last one caught my attention so I decided to try it with curl

	$ curl 127.0.0.2:8000/wp-admin                                     
	<!doctype html>
	<html>
			<head>
					<title>You found it!</title>
			</head>
			<body>
					<h1>You found it!</h1>
					<p>FLAG{tero-wpadmin-3364c855a2ac87341fc7bcbda955b580}</p>
			</body>
	</html>

### c) Install John the Ripper and test it by cracking example files password

I started by installing prerequisites except _zlib-gst_ because it can't be found from Kali Linux packages

	$ sudo apt-get update
	$ sudo apt-get -y install micro bash-completion git build-essential libssl-dev zlib1g zlib1g-dev libbz2-1.0 libbz2-dev atool zip wget

Next I downloaded John the Ripper, Jumbo version

	$ git clone --depth=1 https://github.com/openwall/john.git
	$ cd john/src/
	$ ./configure
	$ make -s clean && make -sj4

I ran John to test if it works

	$ john/run/john 
	John the Ripper 1.9.0-jumbo-1+bleeding-3553509ce9 2023-05-08 13:39:36 +0200 OMP [linux-gnu 64-bit x86_64 AVX2 AC]
	Copyright (c) 1996-2022 by Solar Designer and others
	Homepage: https://www.openwall.com/john/

	Usage: john [OPTIONS] [PASSWORD-FILES]

	Use --help to list all available options.
	
Next I downloaded _tero.zip_ and tried to unzip it

	$ wget https://terokarvinen.com/2023/crack-file-password-with-john/tero.zip
	$ unzip tero.zip
	Archive:  tero.zip
	[tero.zip] secretFiles/SECRET.md password: 
	password incorrect--reenter: 
	   skipping: secretFiles/SECRET.md   incorrect password

I tried to guess the password once but it didn't work so it was time to give the task to John.
First I extracted the hash into a new file called _tero.zip.hash_

	$ john/run/zip2john tero.zip >tero.zip.hash
	ver 1.0 tero.zip/secretFiles/ is not encrypted, or stored with non-handled compression type
	ver 2.0 efh 5455 efh 7875 tero.zip/secretFiles/SECRET.md PKZIP Encr: TS_chk, cmplen=183, decmplen=217, crc=4C752C85 ts=572B cs=572b type=8

And then let John crack the Password

	$ john/run/john tero.zip.hash              
	Using default input encoding: UTF-8
	Loaded 1 password hash (PKZIP [32/64])
	Will run 2 OpenMP threads
	Proceeding with single, rules:Single
	Press 'q' or Ctrl-C to abort, 'h' for help, almost any other key for status
	Almost done: Processing the remaining buffered candidate passwords, if any.
	0g 0:00:00:00 DONE 1/3 (2023-05-13 18:02) 0g/s 2816Kp/s 2816Kc/s 2816KC/s Mdzip1900..Msecret1900
	Proceeding with wordlist:john/run/password.lst
	Enabling duplicate candidate password suppressor
	butterfly        (tero.zip/secretFiles/SECRET.md)     
	1g 0:00:00:00 DONE 2/3 (2023-05-13 18:02) 10.00g/s 886030p/s 886030c/s 886030C/s 123456..bob123
	Use the "--show" option to display all of the cracked passwords reliably
	Session completed. 	
	
On the fourth last row I saw the cracked password and then it was the time to try it on _tero.zip_

	$ unzip tero.zip
	Archive:  tero.zip
	[tero.zip] secretFiles/SECRET.md password: 
	  inflating: secretFiles/SECRET.md   
																				 
	$ cat secretFiles/SECRET.md 
	You've found the secret, well done!

	You have now completed the tutorial. 

	Did you know that Jumbo John can handle many other file formats, too [1]?

	[1] https://TeroKarvinen.com/2023/crack-file-password-with-john/

### d) 


## Sources:

[terokarvinen](https://terokarvinen.com)

https://terokarvinen.com/2022/cracking-passwords-with-hashcat/

https://terokarvinen.com/2023/crack-file-password-with-john/

https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/

wc manual
