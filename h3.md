# H3

**THERE MIGHT BE SOME FORMATTING MISTAKES IN THE FOLLOWING REPORT**

**I WILL TRY TO FIX THE REPORT AS SOON AS POSSIBLE!**

### x) Watch and summarize one [ippsec](https://www.youtube.com/@ippsec/videos) video about hacking

I chose to watch [HackTheBox - Photobomb](https://www.youtube.com/watch?v=-4asq6Tldf0) 

- The main objective was to gain access to the server
- Tech support credentials were found with browser developer tools
- After gaining access to the server burpsuite was used to edit requests to the server
- Final step was to gain root priviledges by abusing a vulnerability in SETENV with sudo on a script


### a) We like to shop. Complete ["Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"](https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data) from Portswigger Academy


### b) HTB. Make HackTheBox.com account. Use OpenVPN connection and block normal internet traffic

First step was to head to [HackTheBox](hackthebox.com) to make an account (I already had an account so I just signed in)

![image](https://user-images.githubusercontent.com/52470440/233840523-0c4f3d05-19b2-41a0-96da-76f0fd58785c.png)

-> _Sign in_ -> _HTB Labs_

![image](https://user-images.githubusercontent.com/52470440/233840585-15fbe647-6bf4-4c3c-b3a3-329e4f176b44.png)

After signing in I pressed from the top right corner _CONNECT TO HTB_ -> _Starting Point_ -> _OpenVPN_ -> _Download VPN_

![image](https://user-images.githubusercontent.com/52470440/233840615-a52474a6-399a-4978-9992-0a92c4493d37.png)

![image](https://user-images.githubusercontent.com/52470440/233840692-16da5233-fe24-47ed-9bc9-0a2a2825623e.png)

![image](https://user-images.githubusercontent.com/52470440/233840721-51d5829b-522c-4f38-9fdc-d06039431544.png)

After donwloading the vpn file I started the connection

    $ cd
    $ cd Downloads
    $ openvpn starting_point_Rabuhana.ovpn
  
  
But I got an error `Exiting due to fatal error`

I tried regenerating the file again but I got the same error so I checked [_TROUBLE CONNECTING_](https://help.hackthebox.com/en/articles/5185536-connection-troubleshooting)

![image](https://user-images.githubusercontent.com/52470440/233841261-16c2b246-9d97-4b30-ac80-9df7c23e5e8d.png)

First I checked if IPv6 was enabled
  
    $ cat /proc/sys/net/ipv6/conf/all/disable_ipv6 
    0

IPv6 was enabled so I continued to the next step which was to run openvpn with root priviledges

    $ sudo openvpn starting_point_Rabuhana.ovpn
    Initialization Sequence Completed
  
I pinged _10.10.14.224_ to confirm the connection works
  
    $ ping 10.10.14.224
    PING 10.10.14.224 (10.10.14.224) 56(84) bytes of data.
    64 bytes from 10.10.14.224: icmp_seq=1 ttl=64 time=0.016 ms
 
 ![image](https://user-images.githubusercontent.com/52470440/233842237-d1e06dc9-3501-47eb-83b0-b9ed2b3479c6.png)

Next I needed to cut the internet connection to anywhere else on that machine

First I tried pinging google.com and 1.1.1.1

    $ ping google.com  
    PING google.com (216.58.209.206) 56(84) bytes of data.
    64 bytes from hem09s03-in-f14.1e100.net (216.58.209.206): icmp_seq=1 ttl=58 time=9.97 ms

    $ ping 1.1.1.1     
    PING 1.1.1.1 (1.1.1.1) 56(84) bytes of data.
    64 bytes from 1.1.1.1: icmp_seq=1 ttl=58 time=14.5 ms

The connection was up

I followed instructions given by [Tero Karvinen](terokarvinen.com) - [OpenVPN helposti ja turvallisesti](https://terokarvinen.com/2023/tunkeutumistestaus-2023-kevat/#h3-the-box)

    $ nm-connection-editor
  
![image](https://user-images.githubusercontent.com/52470440/233842730-5a4bd3cf-13fd-4050-a758-e4f9ea83c576.png)

I clicked _+_ from the bottom left corner and chose _Import a saved VPN configuration..._ from the list -> _Create..._
  
And located the downloaded file

![image](https://user-images.githubusercontent.com/52470440/233842795-fc016894-df8e-491f-af63-1ae9c3ec2be3.png)

-> _Save_

I opened the top right corner menu and chose the VPN connection

![image](https://user-images.githubusercontent.com/52470440/233842907-4ed16d6b-9d16-4ea0-94da-d32621efd816.png)

    $ ping 1.1.1.1
    --- 1.1.1.1 ping statistics ---
    74 packets transmitted, 0 received, 100% packet loss, time 74751ms

    $ ping google.com

I had succesfully cut the connection to normal internet

### c) Meow. Spawn "STarting point": "Meow". Show a screenshot of the page where you can see ip address of the machine and some hacking tasks. Complete the tasks

First I took a screen shot of the ip address of the target machine and the first two tasks

![image](https://user-images.githubusercontent.com/52470440/233862008-25f1c0c7-3d09-4bb3-be23-b2055926faf6.png)

**Task 1**

The first task was to guess "What does the acronym VM stand for?" 

I guessed "Virtual Machine" and it was correct

**Task 2**

"What tool do we use to interact with the operating system in order to issue commands via the command line, such as the one to start our VPN connection? It's also known as a console or shell."

I guessed "terminal" which was correct

**Task 3**

"What service do we use to form our VPN connection into HTB labs?"

I guessed "openvpn" which was correct

**Task 4**

"What is the abbreviated name for a 'tunnel interface' in the output of your VPN boot-up sequence output?"

 I wasn't sure what to put there and after a few tries I guessed "tun" which was correct
 
 **Task 5**
 
"What tool do we use to test our connection to the target with an ICMP echo request?"

I guessed "ping" which was correct

**Task 6**

"What is the name of the most common tool for finding open ports on a target?"

I guessed "nmap" which was correct

**Task 7**

"What service do we identify on port 23/tcp during our scans?"

I didn't have any idea what this should be since usually port 23 is used for ssh so I started by port scanning machines ip address

    $ nmap 10.10.14.224   
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 16:01 EDT
    Nmap scan report for 10.10.14.224
    Host is up (0.000059s latency).
    All 1000 scanned ports on 10.10.14.224 are in ignored states.
    Not shown: 1000 closed tcp ports (conn-refused)

    Nmap done: 1 IP address (1 host up) scanned in 13.05 seconds

The result didn't give me any idea about the service on port 23 so I tried scanning only port 23 of the given ip

    $ nmap 10.10.14.224 -p 23
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 16:06 EDT
    Nmap scan report for 10.10.14.224
    Host is up (0.000068s latency).

    PORT   STATE  SERVICE
    23/tcp closed telnet

    Nmap done: 1 IP address (1 host up) scanned in 13.02 seconds

I tried guessing "telnet" which was correct

After completing this part I realized I was supposed to port scan `10.129.149.245` instead of `10.10.14.224` so I did the same steps to that address too

    $ nmap 10.129.149.245
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 16:26 EDT
    Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn
    Nmap done: 1 IP address (0 hosts up) scanned in 3.04 seconds
  
I decided to try with parameter `-Pn` because of the result I got

    $ nmap 10.129.149.245 -Pn
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 16:26 EDT
    Nmap scan report for 10.129.149.245
    Host is up (0.041s latency).
    All 1000 scanned ports on 10.129.149.245 are in ignored states.
    Not shown: 720 closed tcp ports (conn-refused), 280 filtered tcp ports (no-response)

    Nmap done: 1 IP address (1 host up) scanned in 70.48 seconds

Still no satisfying answer so I tried once more with scanning only port 23

    $ nmap 10.129.149.245 -p 23
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 16:30 EDT
    Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn
    Nmap done: 1 IP address (0 hosts up) scanned in 3.04 seconds

And once more with the parameter `-Pn`

    $ nmap 10.129.149.245 -p 23 -Pn
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 16:30 EDT
    Nmap scan report for 10.129.149.245
    Host is up.

    PORT   STATE    SERVICE
    23/tcp filtered telnet

    Nmap done: 1 IP address (1 host up) scanned in 15.04 seconds
  
I got close to the same result as with the previously tried ip address 

**Task 8**

"What username is able to log into the target over telnet with a blank password?"

This task had a hint in the answer box, "\*\*\*t" which already made me feel like the answer would be _root_ but I wanted to try to connect to the machine with telnet as said in the task

    $ telnet 10.129.149.245 -u root
    telnet: invalid option -- 'u'
    Try 'telnet --help' or 'telnet --usage' for more information.

I decided to check the manual for telnet

    $ man telnet

After some testing with using telnet I finally got access to the machine 
  
    $ telnet 10.129.149.245 -l root
  
**Task 9**

"Submit root flag"

Once I had got in I only needed to find root flag

    root@Meow:~# whoami
    root
    # cd
    # ls
    flag.txt  snap
    # cat flag.txt 
    b40abdfe23665f766f9c61ecba8a4c19
  
![image](https://user-images.githubusercontent.com/52470440/233865593-aab15166-efcd-4c08-9892-e4c2f0549d70.png)

d) Fawn. PWN Fawn

![image](https://user-images.githubusercontent.com/52470440/233865679-09749eae-e72a-4543-8a1d-eab8120c984a.png)

**On some parts of owning this machine I will only show answers if there are no other sources to get the answer than previous experience**

**Task 1**

"What does the 3-letter acronym FTP stand for?"

_file transfer protocol_

**Task 2**

"Which port does the FTP service listen on usually?"

_21_

**Task 3**

"What acronym is used for the secure version of FTP?"

_SFTP_

**Task 4**

"What is the command we can use to send an ICMP echo request to test our connection to the target?"

_ping_

**Task 5**

"From your scans, what version is FTP running on the target?"

I tried port scanning the ip and scanning only port 21

     $ nmap 10.129.186.151 -Pn -p 21

I didn't get satisfactory result so I tried finding an answer on how to detect ftp version with nmap and found [this](https://nmap.org/book/man-version-detection.html)

    $ nmap 10.129.186.151 -sV -Pn -p 21
  
    PORT   STATE    SERVICE VERSION
    21/tcp filtered ftp

Previously I had tried `$ nmap 10.129.186.151 -sV -Pn` but it took a long time so I had stopped the scan

While I tried to check the hints I let that scan run once more

    $ nmap 10.129.186.151 -sV -Pn      
    Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 17:14 EDT
    Nmap scan report for 10.129.186.151
    Host is up (0.043s latency).
    Not shown: 999 closed tcp ports (conn-refused)
    PORT   STATE SERVICE VERSION
    21/tcp open  ftp     vsftpd 3.0.3
    Service Info: OS: Unix

    Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
    Nmap done: 1 IP address (1 host up) scanned in 19.97 seconds
  
And I finally got the answer I was trying to get

_vsftpd 3.0.3_

**Task 6**

"From your scans, what OS type is running on the target?"

From the last scan I did I also got an answer to this too

_unix_

**Task 7**

"What is the command we need to run in order to display the 'ftp' client help menu?"

I guessed this because I didn't think trying to get the answer in terminal would be benefactory if I guessed it right in a few tries

_ftp -h_

**Task 8**

"What is username that is used over FTP when you want to log in without having an account?"

I had no idea so I headed to google and found [this](https://stackoverflow.com/questions/3936911/how-can-i-login-anonymously-with-ftp-usr-bin-ftp)

_anonymous_

**Task 9**

"What is the response code we get for the FTP message 'Login successful'?"

I tried connecting with ftp using anonymous

    $ ftp anonymous@10.129.186.151
    Connected to 10.129.186.151.
    220 (vsFTPd 3.0.3)
    331 Please specify the password.
    Password: 
    230 Login successful.
    Remote system type is UNIX.
    Using binary mode to transfer files.

_230_

**Task 10**

"There are a couple of commands we can use to list the files and directories available on the FTP server. One is dir. What is the other that is a common way to list files on a Linux system."

_ls_

**Task 11**

"What is the command used to download the file we found on the FTP server? "

Again I headed to google and found [this](https://tecadmin.net/download-upload-files-using-ftp-command-line/)

_get_

**Task 12**

Submit root flag 

  $ ftp anonymous@10.129.186.151
  > get flag.txt
  > exit
  
  $ cat flag.txt
  035db21c881520061c53e0536e44f815
  
_035db21c881520061c53e0536e44f815_

![image](https://user-images.githubusercontent.com/52470440/233867310-083c62a7-8d7d-44cd-a0f8-63cf9c469fb9.png)

### e) Dancing. PWN dancing.

**On some parts of owning this machine I will only show answers if there are no other sources to get the answer than previous experience**

![image](https://user-images.githubusercontent.com/52470440/233867506-821b4a14-75d3-49c3-9d79-6dc741574a15.png)

**Task 1**

"What does the 3-letter acronym SMB stand for?"

I had no idea so I headed to google to find [this](https://www.ionos.com/digitalguide/server/know-how/server-message-block-smb/)

_server message block_

**Task 2**

"What port does SMB use to operate at?"

Again I headed to google and found [this](https://4sysops.com/archives/smb-port-number-ports-445-139-138-and-137-explained/)

_445_

**Task 3**

"What is the service name for port 445 that came up in our Nmap scan?"

  $ nmap 10.129.113.54 -Pn -sV
  Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-23 17:40 EDT
  Nmap scan report for 10.129.113.54
  Host is up (0.046s latency).
  Not shown: 997 closed tcp ports (conn-refused)
  PORT    STATE SERVICE       VERSION
  135/tcp open  msrpc         Microsoft Windows RPC
  139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn
  445/tcp open  microsoft-ds?
  Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
  Nmap done: 1 IP address (1 host up) scanned in 114.32 seconds

_microsoft-ds _

**Task 4**

"What is the 'flag' or 'switch' we can use with the SMB tool to 'list' the contents of the share?"

For this task I had no idea so I checked the manual for smb client

  $ man smbclient
  
And searched for _list_

_-L_

**Task 5**

"How many shares are there on Dancing?"

At first I tried to get an access to the machine with smbclient

  $ smbclient 10.129.113.54 -L

I tried figuring out how to find out how many shares there are but even given hint didn't help so I headed to [the walkthrough of this machine](blob:https://app.hackthebox.com/f7058e6a-27e3-444b-bc1c-cadbee74ef53)

I found that I was supposed do put parameter `-L` before the ip address 

  `$ smbclient -L 10.129.113.54
  Password for [WORKGROUP\kali]:

          Sharename       Type      Comment
          ---------       ----      -------
          ADMIN$          Disk      Remote Admin
          C$              Disk      Default share
          IPC$            IPC       Remote IPC
          WorkShares      Disk      
  `
_4_

**Task 6**

"What is the name of the share we are able to access in the end with a blank password?"

I started trying different shares to gain access to the file share

  $ smbclient ADMIN@10.129.113.54
  $ smbclient C$@10.129.113.54
  $ smbclient IPC$@10.129.113.54
  $ smbclient WorkShares@10.129.113.54

None of those worked and I started wondering if I did something wrong and I saw that all of those commands were actually trying to log in with `WORKGROUP\kali`

So I headed to the smbclient manual again

  $ man smbclient

**I couldn't find anything that works and didn't get forward even with the help of the walkthrough**

![image](https://user-images.githubusercontent.com/52470440/233868959-176a89a7-edc0-4fbe-99d4-b0d903db5c82.png)



## Sources: 

https://terokarvinen.com/2023/tunkeutumistestaus-2023-kevat/

https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data

https://www.youtube.com/@ippsec/videos

https://www.youtube.com/watch?v=-4asq6Tldf0

https://help.hackthebox.com/en/articles/5185536-connection-troubleshooting

telnet manual

https://www.wordnik.com/words/ftp

https://www.techtarget.com/searchnetworking/tip/Understanding-the-FTP-PORT-command

blob:https://app.hackthebox.com/f7058e6a-27e3-444b-bc1c-cadbee74ef53

https://4sysops.com/archives/smb-port-number-ports-445-139-138-and-137-explained/

https://www.ionos.com/digitalguide/server/know-how/server-message-block-smb/

https://tecadmin.net/download-upload-files-using-ftp-command-line/

https://stackoverflow.com/questions/3936911/how-can-i-login-anonymously-with-ftp-usr-bin-ftp

smbclient manual

https://nmap.org/book/man-version-detection.html


